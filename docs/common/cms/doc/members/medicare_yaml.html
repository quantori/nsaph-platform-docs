<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medicare.yaml &mdash; NSAPH Data Platform 0.0.2 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sphinx_paramlinks.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Querying Medicaid Data" href="../QueringMedicaid.html" />
    <link rel="prev" title="The fts2yaml Module" href="fts2yaml.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> NSAPH Data Platform
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../home.html">Documentation Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../rationale.html">What is Data Platform</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../domains.html">Data Domains</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Health</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../LegacyMedicaid.html">Importing Medicaid Data Processed by the Legacy Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Medicaid.html">Handling Medicaid data</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../Medicare.html">Medicare Files Handling</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mcr_sas2yaml.html">The mcr_sas2yaml Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcr_sas2db.html">The mcr_sas2db Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="fts2yaml.html">The fts2yaml Module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Medicare.yaml</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Medicaid.html">Handling Medicaid data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Medicare.html#ingesting-raw-files">Ingesting Raw Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Medicare.html#combining-raw-files-into-a-single-view">Combining raw files into a single view</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../QueringMedicaid.html">Querying Medicaid Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#overview-of-health-data-medicare-and-medicaid">Overview of health data (Medicare and Medicaid)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#project-structure">Project Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#documentation-indices">Documentation Indices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../gridmet/doc/index.html">Climate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../epa/doc/index.html">Pollution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../census/doc/index.html">Demographics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pipelines.html">Data Processing Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../packages.html">Python Packages Included in the Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guts.html">Data Platform Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Terms and Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docindices.html">Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">NSAPH Data Platform</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../../domains.html">Data Domains</a> &raquo;</li>
          <li><a href="../index.html">Health Data</a> &raquo;</li>
          <li><a href="../Medicare.html">Medicare Files Handling</a> &raquo;</li>
      <li>Medicare.yaml</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/common/cms/doc/members/medicare_yaml.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="medicare-yaml">
<h1>Medicare.yaml<a class="headerlink" href="#medicare-yaml" title="Permalink to this heading">ÔÉÅ</a></h1>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">medicare</span><span class="p">:</span>
  <span class="nt">reference</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
  <span class="nt">header</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">quoting</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
  <span class="nt">index</span><span class="p">:</span> <span class="s">&quot;unless</span><span class="nv"> </span><span class="s">excluded&quot;</span>
  <span class="nt">schema</span><span class="p">:</span> <span class="s">&quot;medicare&quot;</span>
  <span class="nt">schema.audit</span><span class="p">:</span> <span class="s">&quot;medicare_audit&quot;</span>
  <span class="nt">description</span><span class="p">:</span> <span class="s">&quot;Data</span><span class="nv"> </span><span class="s">model</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">Medicare&quot;</span>
  <span class="nt">tables</span><span class="p">:</span>
    <span class="nt">ps</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">Patient Summary view. Combines multiple patient summary (aka MBSF)</span>
        <span class="no">files into a single view, transforming columns to the same type</span>
      <span class="nt">create</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">view</span>
        <span class="nt">from</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cms.mbsf_ab*</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cms.mcr_bene_*</span>
        <span class="nt">exclude</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mbsf_ab_2015</span>
      <span class="nt">columns</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">file</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">record</span>
        <span class="p p-Indicator">-</span> <span class="nt">year</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">20</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">(2000</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">&quot;year&quot;::int)</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">(20</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">AND</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">100)</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">(1900</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">&quot;year&quot;::int)</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">&quot;year&quot;</span><span class="nv"> </span><span class="s">IS</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">2000</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">END)&#39;</span>
        <span class="p p-Indicator">-</span> <span class="nt">state</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;(SELECT</span><span class="nv"> </span><span class="s">state_id</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">public.us_states</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">s</span><span class="nv"> </span><span class="s">WHERE</span><span class="nv"> </span><span class="s">s.ssa2</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&quot;state&quot;)&#39;</span>
        <span class="p p-Indicator">-</span> <span class="nt">ssa2</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Social Security Administration (SSA) two digit code for state</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.nber.org/research/data/ssa-federal-information-processing-series-fips-state-and-county-crosswalk</span>
        <span class="p p-Indicator">-</span> <span class="nt">fips2</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;(SELECT</span><span class="nv"> </span><span class="s">fips2</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">public.us_states</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">s</span><span class="nv"> </span><span class="s">WHERE</span><span class="nv"> </span><span class="s">s.ssa2</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&quot;state&quot;)&#39;</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2 digit state FIPS, see https://en.wikipedia.org/wiki/Federal_Information_Processing_Standard_state_code</span>
            <span class="nt">reference</span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">https://www.census.gov/library/reference/code-lists/ansi.html#state</span>
        <span class="p p-Indicator">-</span> <span class="nt">zip</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">INT</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">US Postal ZIP code, the first 5 digits of it</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">{column_name}</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">100000</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">{column_name}::int</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">({column_name}/10000)::INT</span><span class="nv"> </span><span class="s">END)&quot;</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;SUBSTRING({column_name}</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">FOR</span><span class="nv"> </span><span class="s">5)::INT&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">zip4</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">INT</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Additional 4 digits for US zip 5+4 code, when provided</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zip</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">{column_name}</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">100000</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">({column_name}%10000)::INT</span><span class="nv"> </span><span class="s">END)&quot;</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">LENGTH({column_name})</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">SUBSTRING({column_name}</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">FOR</span><span class="nv"> </span><span class="s">4)::INT</span><span class="nv"> </span><span class="s">END)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">dob</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Date of birth</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;to_date({column_name},</span><span class="nv"> </span><span class="s">&#39;YYYYMMDD&#39;)&quot;</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;to_date(to_char({column_name},</span><span class="nv"> </span><span class="s">&#39;00000000&#39;),</span><span class="nv"> </span><span class="s">&#39;YYYYMMDD&#39;)&quot;</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dob</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_dob</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_birth_dt</span>
        <span class="p p-Indicator">-</span> <span class="nt">dod</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Date of beneficiary death, if available</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">{column_name}</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&#39;00000000&#39;</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">to_date({column_name},</span><span class="nv"> </span><span class="s">&#39;YYYYMMDD&#39;)</span><span class="nv"> </span><span class="s">END)&quot;</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">{column_name}</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">19000000</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">to_date(to_char({column_name},</span><span class="nv"> </span><span class="s">&#39;00000000&#39;),</span><span class="nv"> </span><span class="s">&#39;YYYYMMDD&#39;)</span><span class="nv"> </span><span class="s">END)&quot;</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">death_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bef_dod</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_dod</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_death_dt</span>
        <span class="p p-Indicator">-</span> <span class="nt">ssa3</span><span class="p">:</span>
            <span class="nt">optional</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Social Security Administration (SSA) three digit code for county</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.nber.org/research/data/ssa-federal-information-processing-series-fips-state-and-county-crosswalk</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cnty_cd</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_county_cd</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ssa_county</span>
        <span class="p p-Indicator">-</span> <span class="nt">sex</span><span class="p">:</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://resdac.org/cms-data/variables/sex-beneficiary-0</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sex</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_sex_ident_cd</span>
        <span class="p p-Indicator">-</span> <span class="nt">race</span><span class="p">:</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://resdac.org/cms-data/variables/beneficiary-race-code-ffs</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_race_cd</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">race</span>
        <span class="p p-Indicator">-</span> <span class="nt">dod_ndi</span><span class="p">:</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">This variable is the date of death as reported on the Beneficiary‚Äôs death certificate.</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://resdac.org/cms-data/variables/ndi-date-deathmbsf</span>
            <span class="nt">optional</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
            <span class="nt">source</span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">ndi_death_dt</span>
        <span class="p p-Indicator">-</span> <span class="nt">race_rti</span><span class="p">:</span>
            <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Research Triangle Institute (RTI) Race Code</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://resdac.org/cms-data/variables/research-triangle-institute-rti-race-code</span>
            <span class="nt">optional</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rti_race_cd</span>
    <span class="nt">ip</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">Inpatient Adminissions view. Combines multiple inpatient admissions</span>
        <span class="no">files (aka MedPar) into a single view, transforming columns</span>
        <span class="no">to the same type</span>
      <span class="nt">create</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">view</span>
        <span class="nt">from</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cms.medpar_*</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cms.mcr_ip_*</span>
        <span class="nt">exclude</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medpar_2015</span>
      <span class="nt">columns</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">file</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">record</span>
        <span class="p p-Indicator">-</span> <span class="nt">year</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">20</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">(2000</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">&quot;year&quot;::int)</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">(20</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">AND</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">100)</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">(1900</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">&quot;year&quot;::int)</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">&quot;year&quot;</span><span class="nv"> </span><span class="s">IS</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">2000</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">&quot;year&quot;::int</span><span class="nv"> </span><span class="s">END)&#39;</span>
        <span class="p p-Indicator">-</span> <span class="nt">state</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;(SELECT</span><span class="nv"> </span><span class="s">state_id</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">public.us_states</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">s</span><span class="nv"> </span><span class="s">WHERE</span><span class="nv"> </span><span class="s">s.ssa2</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&quot;state&quot;)&#39;</span>
        <span class="p p-Indicator">-</span> <span class="nt">ssa2</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
        <span class="p p-Indicator">-</span> <span class="nt">fips2</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;(SELECT</span><span class="nv"> </span><span class="s">fips2</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">public.us_states</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">s</span><span class="nv"> </span><span class="s">WHERE</span><span class="nv"> </span><span class="s">s.ssa2</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&quot;state&quot;)&#39;</span>
        <span class="p p-Indicator">-</span> <span class="nt">zip</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">INT</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">{column_name}</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">100000</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">{column_name}::int</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">({column_name}/10000)::INT</span><span class="nv"> </span><span class="s">END)&quot;</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;SUBSTRING({column_name}</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">FOR</span><span class="nv"> </span><span class="s">5)::INT&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">zip4</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">INT</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zip</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">{column_name}</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">100000</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">({column_name}%10000)::INT</span><span class="nv"> </span><span class="s">END)&quot;</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;(CASE</span><span class="nv"> </span><span class="s">WHEN</span><span class="nv"> </span><span class="s">LENGTH({column_name})</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">THEN</span><span class="nv"> </span><span class="s">NULL</span><span class="nv"> </span><span class="s">ELSE</span><span class="nv"> </span><span class="s">SUBSTRING({column_name}</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">FOR</span><span class="nv"> </span><span class="s">4)::INT</span><span class="nv"> </span><span class="s">END)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">admission_date_raw</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VARCHAR</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;TRIM(to_char({column_name},</span><span class="nv"> </span><span class="s">&#39;999999999&#39;))&quot;</span>
              <span class="s">&#39;*&#39;</span><span class="p p-Indicator">:</span> <span class="s">&quot;{column_name}::VARCHAR&quot;</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medpar_admsn_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">admsn_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">admsndt</span>
        <span class="p p-Indicator">-</span> <span class="nt">admission_date</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DATE</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;public.parse_date({column_name})&quot;</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;public.parse_date({column_name})&quot;</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medpar_admsn_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">admsn_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">admsndt</span>

        <span class="p p-Indicator">-</span> <span class="nt">discharge_date_raw</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VARCHAR</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;TRIM(to_char({column_name},</span><span class="nv"> </span><span class="s">&#39;999999999&#39;))&quot;</span>
              <span class="s">&#39;*&#39;</span><span class="p p-Indicator">:</span> <span class="s">&quot;{column_name}::VARCHAR&quot;</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medpar_dschrg_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dschrg_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dschrgdt</span>
        <span class="p p-Indicator">-</span> <span class="nt">discharge_date</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DATE</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;public.parse_date({column_name})&quot;</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;public.parse_date({column_name})&quot;</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medpar_dschrg_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dschrg_dt</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dschrgdt</span>

        <span class="p p-Indicator">-</span> <span class="nt">adm_day_of_week</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">INT</span>
            <span class="nt">cast</span><span class="p">:</span>
              <span class="s">&quot;character</span><span class="nv"> </span><span class="s">varying&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;{column_name}::INT&quot;</span>
              <span class="nt">numeric</span><span class="p">:</span> <span class="s">&quot;{column_name}::INT&quot;</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medpar_admsn_day_cd</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">admsn_day_cd</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">admsnday</span>

        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">diag[$n=1:25]</span><span class="p p-Indicator">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">varchar</span>
            <span class="nt">optional</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">medpar_dgns_cd_$n</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dgns_cd0$n</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dgns_cd$n</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dgns_$n_cd</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dgnscd$n</span>
    <span class="nt">_ps</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">internal intermediate view adding some data conversions</span>
      <span class="nt">create</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">view</span>
        <span class="nt">select</span><span class="p">:</span> <span class="p p-Indicator">|</span>
          <span class="no">*,</span>
          <span class="no">CASE WHEN ssa3 is NOT NULL THEN</span>
            <span class="no">CASE WHEN year &gt; 2010 THEN</span>
                <span class="no">(SELECT fips3 from public.ssa as s where ps.ssa3 = s.ssa3 and ps.year = s.year and ps.fips2 = s.fips2 ORDER BY 1 DESC LIMIT 1)</span>
              <span class="no">ELSE</span>
                <span class="no">(SELECT fips3 from public.ssa as s where ps.ssa3 = s.ssa3 and 2003 = s.year and ps.fips2 = s.fips2 ORDER BY 1 DESC LIMIT 1)</span>
            <span class="no">END</span>
          <span class="no">ELSE</span>
            <span class="no">(SELECT public.zip_to_fips3(year, zip))</span>
          <span class="no">END AS fips3,</span>
          <span class="no">CASE WHEN ssa3 is NOT NULL THEN</span>
              <span class="no">False</span>
            <span class="no">ELSE</span>
              <span class="no">(SELECT NOT public.is_zip_to_fips_exact(year, zip))</span>
          <span class="no">END AS fips3_is_approximated,</span>
          <span class="no">CASE WHEN year &gt; 2010 THEN (SELECT string_agg(distinct fips3::varchar, &#39;,&#39;) from public.ssa as s where ps.ssa3 = s.ssa3 and ps.year = s.year and ps.fips2 = s.fips2)</span>
              <span class="no">ELSE (SELECT string_agg(distinct fips3::varchar, &#39;,&#39;) from public.ssa as s where ps.ssa3 = s.ssa3 and 2003 = s.year and ps.fips2 = s.fips2) END AS fips3_list</span>
        <span class="nt">from</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ps</span>
    <span class="nt">_beneficiaries</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">internal intermediate view adding some data conversions</span>
      <span class="nt">create</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">view</span>
        <span class="nt">from</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">medicare.ps</span>
        <span class="nt">group by</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
      <span class="nt">columns</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
        <span class="p p-Indicator">-</span> <span class="nt">dob</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;MIN(dob)&quot;</span>
            <span class="nt">identifier</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="p p-Indicator">-</span> <span class="nt">dod</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;MAX(dod)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">race</span><span class="p">:</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="s">&quot;https://resdac.org/cms-data/variables/raceethnicity-msis&quot;</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;string_agg(distinct</span><span class="nv"> </span><span class="s">race,</span><span class="nv"> </span><span class="s">&#39;,&#39;)&quot;</span>
            <span class="nt">identifier</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="p p-Indicator">-</span> <span class="nt">sex</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;string_agg(distinct</span><span class="nv"> </span><span class="s">sex,</span><span class="nv"> </span><span class="s">&#39;,&#39;)&quot;</span>
            <span class="nt">identifier</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="p p-Indicator">-</span> <span class="nt">duplicates</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">&gt;</span>
              <span class="no">COUNT(distinct {identifiers}) +</span>
              <span class="no">CASE (COUNT(DISTINCT dod) FILTER (WHERE dod is not null)) WHEN 0 THEN 0 ELSE COUNT(DISTINCT dod) FILTER (WHERE dod is not null) - 1 END</span>
            <span class="nt">description</span><span class="p">:</span> <span class="s">&quot;number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">duplicate</span><span class="nv"> </span><span class="s">records</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">beneficiary&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">dob_latest</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
              <span class="no">CASE</span>
                <span class="no">WHEN MAX(dob) &lt;&gt; MIN(dob) THEN  MAX(dob)</span>
              <span class="no">END</span>
        <span class="p p-Indicator">-</span> <span class="nt">dod_earliest</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
              <span class="no">CASE</span>
                <span class="no">WHEN MIN(dod) &lt;&gt; MAX(dod) THEN MIN(dod)</span>
              <span class="no">END</span>
    <span class="nt">_enrollments</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">Internal intermediate view of beneficiary enrollments into</span>
        <span class="no">Medicare program, by year and state of enrollment</span>
      <span class="nt">create</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">view</span>
        <span class="nt">from</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">medicare._ps</span>
        <span class="nt">group by</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
      <span class="nt">columns</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
        <span class="p p-Indicator">-</span> <span class="nt">state_iso</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;(&#39;US-&#39;</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">state)</span><span class="nv"> </span><span class="s">&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">fips2</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MAX(fips2)</span>
        <span class="p p-Indicator">-</span> <span class="nt">fips3</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MAX(fips3)</span>
        <span class="p p-Indicator">-</span> <span class="nt">fips3_is_approximated</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">every(fips3_is_approximated)</span>
        <span class="p p-Indicator">-</span> <span class="nt">fips3_valdiated</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">public.validate_zip_fips(MAX(zip), MAX(fips2), MAX(fips3))</span>
        <span class="p p-Indicator">-</span> <span class="nt">ssa2</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MAX(ssa2)</span>
        <span class="p p-Indicator">-</span> <span class="nt">ssa3</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MAX(ssa3)</span>
        <span class="p p-Indicator">-</span> <span class="nt">ssa2_list</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;string_agg(distinct</span><span class="nv"> </span><span class="s">ssa2,</span><span class="nv"> </span><span class="s">&#39;,&#39;)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">ssa3_list</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;string_agg(distinct</span><span class="nv"> </span><span class="s">ssa3,</span><span class="nv"> </span><span class="s">&#39;,&#39;)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">residence_county</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MAX(fips3)</span>
        <span class="p p-Indicator">-</span> <span class="nt">residence_counties</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;string_agg(distinct</span><span class="nv"> </span><span class="s">fips3_list,</span><span class="nv"> </span><span class="s">&#39;,&#39;)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">fips5</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;(MAX(fips2)</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">MAX(fips3))&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">zip</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;MAX(zip)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">zips</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="s">&quot;string_agg(distinct</span><span class="nv"> </span><span class="s">zip::varchar,</span><span class="nv"> </span><span class="s">&#39;,&#39;)&quot;</span>
        <span class="p p-Indicator">-</span> <span class="nt">state_count</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
              <span class="no">(</span>
                <span class="no">SELECT COUNT(distinct state)</span>
                <span class="no">FROM medicare.ps AS ps2</span>
                <span class="no">WHERE</span>
                  <span class="no">_ps.bene_id = ps2.bene_id</span>
                  <span class="no">AND _ps.year = ps2.year</span>
              <span class="no">)</span>
        <span class="p p-Indicator">-</span> <span class="nt">died</span><span class="p">:</span>
            <span class="nt">source</span><span class="p">:</span> <span class="p p-Indicator">|</span>
              <span class="no">CASE EXTRACT (YEAR from MAX(dod))</span>
                <span class="no">WHEN year THEN TRUE</span>
                <span class="no">ELSE FALSE</span>
              <span class="no">END</span>

    <span class="nt">beneficiaries</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">Cleaned up and unified Medicare beneficiaries table,</span>
        <span class="no">indexed and optimized for efficient queries</span>
      <span class="nt">create</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">table</span>
        <span class="nt">select</span><span class="p">:</span> <span class="s">&quot;*&quot;</span>
        <span class="nt">from</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">_beneficiaries</span>
      <span class="nt">columns</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">bene</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HLL_HASHVAL</span>
            <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
              <span class="no">HLL hash (see https://en.wikipedia.org/wiki/HyperLogLog).</span>
              <span class="no">Can be sued to calculate number of beneficiaries</span>
              <span class="no">satisfying a certain given condition</span>
              <span class="no">Use #(hll_add_agg(bene)) or hll_cardinality(hll_add_agg(bene)) aggregator</span>
            <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/citusdata/postgresql-hll/blob/master/REFERENCE.md#basic-operational-functions</span>
            <span class="nt">source</span><span class="p">:</span>
              <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;generated&quot;</span>
              <span class="nt">code</span><span class="p">:</span> <span class="s">&quot;GENERATED</span><span class="nv"> </span><span class="s">ALWAYS</span><span class="nv"> </span><span class="s">AS</span><span class="nv"> </span><span class="s">(hll_hash_text(bene_id))</span><span class="nv"> </span><span class="s">STORED&quot;</span>
      <span class="nt">primary_key</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
      <span class="nt">indices</span><span class="p">:</span>
        <span class="nt">bene_rsd_idx</span><span class="p">:</span>
          <span class="nt">columns</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">race</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sex</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">duplicates</span>
      <span class="nt">children</span><span class="p">:</span>
        <span class="nt">enrollments</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
            <span class="no">Cleaned up and unified Medicare beneficiaries enrollments table,</span>
            <span class="no">by satte and year. This table is indexed and optimized</span>
            <span class="no">for efficient queries</span>
          <span class="nt">create</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">table</span>
            <span class="nt">select</span><span class="p">:</span> <span class="s">&quot;*&quot;</span>
            <span class="nt">from</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">_enrollments</span>
          <span class="nt">columns</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">bene</span><span class="p">:</span>
                <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HLL_HASHVAL</span>
                <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
                  <span class="no">HLL hash (see https://en.wikipedia.org/wiki/HyperLogLog).</span>
                  <span class="no">Can be sued to calculate number of beneficiaries</span>
                  <span class="no">satisfying a certain given condition</span>
                  <span class="no">Use #(hll_add_agg(bene)) or hll_cardinality(hll_add_agg(bene)) aggregator</span>
                <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/citusdata/postgresql-hll/blob/master/REFERENCE.md#basic-operational-functions</span>
                <span class="nt">source</span><span class="p">:</span>
                  <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;generated&quot;</span>
                  <span class="nt">code</span><span class="p">:</span> <span class="s">&quot;GENERATED</span><span class="nv"> </span><span class="s">ALWAYS</span><span class="nv"> </span><span class="s">AS</span><span class="nv"> </span><span class="s">(hll_hash_text(bene_id))</span><span class="nv"> </span><span class="s">STORED&quot;</span>
          <span class="nt">primary_key</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
          <span class="nt">indices</span><span class="p">:</span>
            <span class="nt">bsy_idx</span><span class="p">:</span>
              <span class="nt">columns</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
            <span class="nt">sy_idx</span><span class="p">:</span>
              <span class="nt">columns</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
            <span class="nt">fips_idx</span><span class="p">:</span>
              <span class="nt">columns</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fips2</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fips3</span>
            <span class="nt">zc_idx</span><span class="p">:</span>
              <span class="nt">columns</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">zip</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fips5</span>
            <span class="nt">scz_idx</span><span class="p">:</span>
              <span class="nt">columns</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fips3</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">zip</span>
          <span class="nt">children</span><span class="p">:</span>
            <span class="nt">admissions</span><span class="p">:</span>
              <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
                <span class="no">Medicare inpatient admissions</span>
              <span class="nt">invalid.records</span><span class="p">:</span>
                <span class="nt">action</span><span class="p">:</span> <span class="s">&quot;INSERT&quot;</span>
                <span class="nt">target</span><span class="p">:</span>
                  <span class="nt">schema</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$schema.audit</span>
              <span class="nt">create</span><span class="p">:</span>
                <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">table</span>
                <span class="nt">select</span><span class="p">:</span> <span class="p p-Indicator">|</span>
                  <span class="no">bene_id,</span>
                  <span class="no">file,</span>
                  <span class="no">record,</span>
                  <span class="no">year,</span>
                  <span class="no">state,</span>
                  <span class="no">ssa2,</span>
                  <span class="no">fips2,</span>
                  <span class="no">zip,</span>
                  <span class="no">zip4,</span>
                  <span class="no">admission_date_raw,</span>
                  <span class="no">discharge_date_raw,</span>
                  <span class="no">admission_date,</span>
                  <span class="no">discharge_date,</span>
                  <span class="no">adm_day_of_week,</span>
                  <span class="no">diag1 As primary_diagnosis,</span>
                  <span class="no">array_remove(ARRAY[diag1,</span>
                  <span class="no">diag2,</span>
                  <span class="no">diag3,</span>
                  <span class="no">diag4,</span>
                  <span class="no">diag5,</span>
                  <span class="no">diag6,</span>
                  <span class="no">diag7,</span>
                  <span class="no">diag8,</span>
                  <span class="no">diag9,</span>
                  <span class="no">diag10,</span>
                  <span class="no">diag11,</span>
                  <span class="no">diag12,</span>
                  <span class="no">diag13,</span>
                  <span class="no">diag14,</span>
                  <span class="no">diag15,</span>
                  <span class="no">diag16,</span>
                  <span class="no">diag17,</span>
                  <span class="no">diag18,</span>
                  <span class="no">diag19,</span>
                  <span class="no">diag20,</span>
                  <span class="no">diag21,</span>
                  <span class="no">diag22,</span>
                  <span class="no">diag23,</span>
                  <span class="no">diag24,</span>
                  <span class="no">diag25], NULL) As diagnoses</span>
                <span class="nt">from</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ip</span>
                <span class="nt">populate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
              <span class="nt">columns</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="nt">admission_year</span><span class="p">:</span>
                    <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;INT&quot;</span>
                    <span class="nt">source</span><span class="p">:</span>
                      <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;generated&quot;</span>
                      <span class="nt">code</span><span class="p">:</span> <span class="s">&quot;GENERATED</span><span class="nv"> </span><span class="s">ALWAYS</span><span class="nv"> </span><span class="s">AS</span><span class="nv"> </span><span class="s">(EXTRACT</span><span class="nv"> </span><span class="s">(YEAR</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">admission_date))</span><span class="nv"> </span><span class="s">STORED&quot;</span>
                <span class="p p-Indicator">-</span> <span class="nt">diagnoses</span><span class="p">:</span>
                    <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;VARCHAR(12)[10]&quot;</span>
                    <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">None</span>
                <span class="p p-Indicator">-</span> <span class="nt">bene</span><span class="p">:</span>
                    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HLL_HASHVAL</span>
                    <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
                      <span class="no">HLL hash (see https://en.wikipedia.org/wiki/HyperLogLog).</span>
                      <span class="no">Can be sued to calculate number of beneficiaries</span>
                      <span class="no">satisfying a certain given condition</span>
                      <span class="no">Use #(hll_add_agg(bene)) or hll_cardinality(hll_add_agg(bene)) aggregator</span>
                    <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/citusdata/postgresql-hll/blob/master/REFERENCE.md#basic-operational-functions</span>
                    <span class="nt">source</span><span class="p">:</span>
                      <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;generated&quot;</span>
                      <span class="nt">code</span><span class="p">:</span> <span class="s">&quot;GENERATED</span><span class="nv"> </span><span class="s">ALWAYS</span><span class="nv"> </span><span class="s">AS</span><span class="nv"> </span><span class="s">(hll_hash_text(bene_id))</span><span class="nv"> </span><span class="s">STORED&quot;</span>
                    <span class="nt">index</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
                <span class="p p-Indicator">-</span> <span class="nt">pd_hll_hash</span><span class="p">:</span>
                    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HLL_HASHVAL</span>
                    <span class="nt">source</span><span class="p">:</span>
                      <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;generated&quot;</span>
                      <span class="nt">code</span><span class="p">:</span> <span class="s">&quot;GENERATED</span><span class="nv"> </span><span class="s">ALWAYS</span><span class="nv"> </span><span class="s">AS</span><span class="nv"> </span><span class="s">(hll_hash_text(primary_diagnosis))</span><span class="nv"> </span><span class="s">STORED&quot;</span>
                    <span class="nt">index</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
                <span class="p p-Indicator">-</span> <span class="nt">icd_hll</span><span class="p">:</span>
                    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HLL</span>
                    <span class="nt">source</span><span class="p">:</span>
                      <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;generated&quot;</span>
                      <span class="nt">code</span><span class="p">:</span> <span class="s">&quot;GENERATED</span><span class="nv"> </span><span class="s">ALWAYS</span><span class="nv"> </span><span class="s">AS</span><span class="nv"> </span><span class="s">(hll_arr_agg(diagnoses))</span><span class="nv"> </span><span class="s">STORED&quot;</span>
                    <span class="nt">index</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
              <span class="nt">primary_key</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bene_id</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">admission_date</span>
                <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">discharge_date</span>
              <span class="nt">indices</span><span class="p">:</span>
                <span class="nt">adm_ys_idx</span><span class="p">:</span>
                  <span class="nt">columns</span><span class="p">:</span>
                    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
                    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
                <span class="nt">adm_ysdz_idx</span><span class="p">:</span>
                  <span class="nt">columns</span><span class="p">:</span>
                    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state</span>
                    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">year</span>
                    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">zip</span>
                    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">primary_diagnosis</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fts2yaml.html" class="btn btn-neutral float-left" title="The fts2yaml Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../QueringMedicaid.html" class="btn btn-neutral float-right" title="Querying Medicaid Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Harvard University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>